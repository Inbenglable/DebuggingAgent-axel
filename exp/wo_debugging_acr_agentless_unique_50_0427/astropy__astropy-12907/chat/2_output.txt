Understanding that the `separability_matrix` function uses a helper function `_separable`, it's crucial to examine the implementation of `_separable` to address the root of the issue with nested compound models. Without knowing the file path or whether it's a standalone function or method within a class, I will need to search for `_separable` in the codebase.

```python
search_method_in_codebase("_separable")
```
