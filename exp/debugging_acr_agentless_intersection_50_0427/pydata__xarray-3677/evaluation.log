============================= test session starts ==============================
platform linux -- Python 3.10.16, pytest-7.4.0, pluggy-1.5.0
rootdir: /data/swe-fl/TMP/testbed/pydata__xarray-3677
configfile: setup.cfg
plugins: xdist-3.6.1, cov-6.0.0, env-1.1.5, hypothesis-6.123.7
collected 22 items

xarray/tests/test_merge.py .............F........                        [100%]

=================================== FAILURES ===================================
__________________________ TestMergeMethod.test_merge __________________________

self = <xarray.tests.test_merge.TestMergeMethod object at 0x7f705712b490>

    def test_merge(self):
        data = create_test_data()
        ds1 = data[["var1"]]
        ds2 = data[["var3"]]
        expected = data[["var1", "var3"]]
        actual = ds1.merge(ds2)
        assert expected.identical(actual)
    
        actual = ds2.merge(ds1)
        assert expected.identical(actual)
    
        actual = data.merge(data)
        assert data.identical(actual)
        actual = data.reset_coords(drop=True).merge(data)
        assert data.identical(actual)
        actual = data.merge(data.reset_coords(drop=True))
        assert data.identical(actual)
    
        with pytest.raises(ValueError):
            ds1.merge(ds2.rename({"var3": "var1"}))
        with raises_regex(ValueError, "should be coordinates or not"):
            data.reset_coords().merge(data)
>       with raises_regex(ValueError, "should be coordinates or not"):

xarray/tests/test_merge.py:160: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <contextlib._GeneratorContextManager object at 0x7f705712a050>
typ = None, value = None, traceback = None

    def __exit__(self, typ, value, traceback):
        if typ is None:
            try:
>               next(self.gen)
E               Failed: DID NOT RAISE <class 'ValueError'>

/root/miniforge3/envs/pydata__xarray__0.12/lib/python3.10/contextlib.py:142: Failed
=============================== warnings summary ===============================
xarray/core/dask_array_compat.py:13
xarray/core/dask_array_compat.py:13
  /data/swe-fl/TMP/testbed/pydata__xarray-3677/xarray/core/dask_array_compat.py:13: DeprecationWarning: distutils Version classes are deprecated. Use packaging.version instead.
    if LooseVersion(dask_version) >= LooseVersion("2.0.0"):

xarray/core/dask_array_compat.py:100
xarray/core/dask_array_compat.py:100
  /data/swe-fl/TMP/testbed/pydata__xarray-3677/xarray/core/dask_array_compat.py:100: DeprecationWarning: distutils Version classes are deprecated. Use packaging.version instead.
    if LooseVersion(dask_version) >= LooseVersion("2.8.1"):

xarray/core/dask_array_compat.py:137
xarray/core/dask_array_compat.py:137
  /data/swe-fl/TMP/testbed/pydata__xarray-3677/xarray/core/dask_array_compat.py:137: DeprecationWarning: distutils Version classes are deprecated. Use packaging.version instead.
    if LooseVersion(dask_version) > LooseVersion("2.9.0"):

xarray/core/formatting_html.py:6
  /data/swe-fl/TMP/testbed/pydata__xarray-3677/xarray/core/formatting_html.py:6: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html
    import pkg_resources

xarray/core/pdcompat.py:45
  /data/swe-fl/TMP/testbed/pydata__xarray-3677/xarray/core/pdcompat.py:45: DeprecationWarning: distutils Version classes are deprecated. Use packaging.version instead.
    if LooseVersion(pd.__version__) < "0.25.0":

../../../../../root/miniforge3/envs/pydata__xarray__0.12/lib/python3.10/site-packages/setuptools/_distutils/version.py:345
  /root/miniforge3/envs/pydata__xarray__0.12/lib/python3.10/site-packages/setuptools/_distutils/version.py:345: DeprecationWarning: distutils Version classes are deprecated. Use packaging.version instead.
    other = LooseVersion(other)

xarray/tests/test_merge.py: 17 warnings
  /data/swe-fl/TMP/testbed/pydata__xarray-3677/xarray/core/alignment.py:298: FutureWarning: Index.__or__ operating as a set operation is deprecated, in the future this will be a logical operation matching Series.__or__.  Use index.union(other) instead.
    index = joiner(matching_indexes)

xarray/tests/test_merge.py::TestMergeFunction::test_merge_no_conflicts_single_var
xarray/tests/test_merge.py::TestMergeMethod::test_merge_auto_align
xarray/tests/test_merge.py::TestMergeMethod::test_merge_auto_align
xarray/tests/test_merge.py::TestMergeMethod::test_merge_no_conflicts
  /data/swe-fl/TMP/testbed/pydata__xarray-3677/xarray/core/alignment.py:298: FutureWarning: Index.__and__ operating as a set operation is deprecated, in the future this will be a logical operation matching Series.__and__.  Use index.intersection(other) instead.
    index = joiner(matching_indexes)

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
==================================== PASSES ====================================
=========================== short test summary info ============================
PASSED xarray/tests/test_merge.py::TestMergeInternals::test_broadcast_dimension_size
PASSED xarray/tests/test_merge.py::TestMergeFunction::test_merge_arrays
PASSED xarray/tests/test_merge.py::TestMergeFunction::test_merge_datasets
PASSED xarray/tests/test_merge.py::TestMergeFunction::test_merge_dataarray_unnamed
PASSED xarray/tests/test_merge.py::TestMergeFunction::test_merge_dicts_simple
PASSED xarray/tests/test_merge.py::TestMergeFunction::test_merge_dicts_dims
PASSED xarray/tests/test_merge.py::TestMergeFunction::test_merge_error
PASSED xarray/tests/test_merge.py::TestMergeFunction::test_merge_alignment_error
PASSED xarray/tests/test_merge.py::TestMergeFunction::test_merge_wrong_input_error
PASSED xarray/tests/test_merge.py::TestMergeFunction::test_merge_no_conflicts_single_var
PASSED xarray/tests/test_merge.py::TestMergeFunction::test_merge_no_conflicts_multi_var
PASSED xarray/tests/test_merge.py::TestMergeFunction::test_merge_no_conflicts_preserve_attrs
PASSED xarray/tests/test_merge.py::TestMergeFunction::test_merge_no_conflicts_broadcast
PASSED xarray/tests/test_merge.py::TestMergeMethod::test_merge_broadcast_equals
PASSED xarray/tests/test_merge.py::TestMergeMethod::test_merge_compat
PASSED xarray/tests/test_merge.py::TestMergeMethod::test_merge_auto_align
PASSED xarray/tests/test_merge.py::TestMergeMethod::test_merge_fill_value[fill_value0]
PASSED xarray/tests/test_merge.py::TestMergeMethod::test_merge_fill_value[2]
PASSED xarray/tests/test_merge.py::TestMergeMethod::test_merge_fill_value[2.0]
PASSED xarray/tests/test_merge.py::TestMergeMethod::test_merge_no_conflicts
PASSED xarray/tests/test_merge.py::TestMergeMethod::test_merge_dataarray
FAILED xarray/tests/test_merge.py::TestMergeMethod::test_merge - Failed: DID ...
================== 1 failed, 21 passed, 30 warnings in 3.29s ===================

ERROR conda.cli.main_run:execute(125): `conda run pytest -rA xarray/tests/test_merge.py` failed. (See above for error)
