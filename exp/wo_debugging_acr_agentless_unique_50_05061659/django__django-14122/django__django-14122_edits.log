### django/db/models/sql/compiler.py
<<<<<<< SEARCH
        for expr, (sql, params, is_ref) in order_by:
            # Skip References to the select clause, as all expressions in the
            # select clause are already part of the group by.
            if not is_ref:
                expressions.extend(expr.get_group_by_cols())
=======
        if hasattr(self, '_meta_ordering'):
            meta_ordering_exprs = {
                expr for expr, (sql, params, is_ref) in order_by
                if hasattr(expr, 'base') and expr.base in self._meta_ordering
            }
        else:
            meta_ordering_exprs = set()

        for expr, (sql, params, is_ref) in order_by:
            # Exclude fields derived from Meta.ordering for group by
            if not is_ref and expr not in meta_ordering_exprs:
                expressions.extend(expr.get_group_by_cols())
>>>>>>> REPLACE
