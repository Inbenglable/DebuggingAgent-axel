To properly address this issue and generate a patch, I need to understand the context in which `opts = cur_model._meta` is used within the applicable function or method in `django/db/models/sql/query.py`. I haven't retrieved the method code where this line is present. Therefore, I will search for the method code in which this snippet is located.

```python
search_method_in_file("django/db/models/sql/query.py", "get_related_populators")
```
