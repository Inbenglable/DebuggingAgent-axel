I've obtained the necessary source code for the `NDArithmeticMixin._arithmetic_mask` method, which is responsible for the mask handling logic that is causing the issue. This is sufficient to proceed with generating a patch to resolve the reported bug.

Ready generation: `True`
